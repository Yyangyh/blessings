(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/com_page/video_details"],{"3ae8":function(e,t,i){"use strict";i.r(t);var a=i("3bea"),n=i.n(a);for(var r in a)"default"!==r&&function(e){i.d(t,e,(function(){return a[e]}))}(r);t["default"]=n.a},"3bea":function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=o(i("4795")),n=o(i("082c")),r=o(i("be83"));function o(e){return e&&e.__esModule?e:{default:e}}function s(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=c(e))){var t=0,i=function(){};return{s:i,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,n,r=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return r=e.done,e},e:function(e){o=!0,n=e},f:function(){try{r||null==a.return||a.return()}finally{if(o)throw n}}}}function c(e,t){if(e){if("string"===typeof e)return d(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(i):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=new Array(t);i<t;i++)a[i]=e[i];return a}function u(e,t,i,a,n,r,o){try{var s=e[r](o),c=s.value}catch(d){return void i(d)}s.done?t(c):Promise.resolve(c).then(a,n)}function l(e){return function(){var t=this,i=arguments;return new Promise((function(a,n){var r=e.apply(t,i);function o(e){u(r,a,n,o,s,"next",e)}function s(e){u(r,a,n,o,s,"throw",e)}o(void 0)}))}}var _=function(){i.e("pages/common/load").then(function(){return resolve(i("22c2"))}.bind(null,i)).catch(i.oe)},f=function(){i.e("pages/common/share").then(function(){return resolve(i("39dd"))}.bind(null,i)).catch(i.oe)},h=function(){i.e("components/wangding-audioQuickPlay/index").then(function(){return resolve(i("c161"))}.bind(null,i)).catch(i.oe)},v=e.getBackgroundAudioManager(),p={components:{load:_,share:f,Audio:h},data:function(){return{id:"",type:"",data:"",video_data:"",video_content:"",test_show:1,catalog_data:"",play_url:"",indexs:"",show:!1,collects:"",tips_test:"",tips_img:"",coupon_data:"",coupon_show:!1,comments:"",recommend_video:"",play_store:!1,poster:"",record_time:0,load_show:!0,duration_time:"",receive_status:!1,initial_time:0,share_arr:{},lock:!1,status:2,currentTime:0,duration:100,videoContext:""}},computed:{is_free:function(){return 1!=this.video_data.is_free&&(0==this.video_data.is_free?-1==this.video_data.is_free_vip.indexOf(this.$store.state.user.level_id)&&1!=this.data.vorder.is_bay_all:void 0)},timer:function(){return m(this.currentTime)},overTimer:function(){return m(this.duration)}},methods:{play:function(){this.status=2,v.play()},stop:function(){v.pause(),this.status=1},Au_timeupdate:function(e){if(!this.lock){var t,i;if(e.detail.detail?(t=e.detail.detail.currentTime,i=e.detail.detail.duration):(t=e.detail.currentTime,i=e.detail.duration),this.duration_time=e.detail.duration,(this.indexs||0===this.indexs)&&Math.ceil(e.detail.currentTime)%10==0&&Math.ceil(e.detail.currentTime)!=this.record_time){this.record_time=Math.ceil(e.detail.currentTime),this.record_play(e.detail.currentTime,e.detail.duration);var a=Math.round(Math.ceil(e.detail.currentTime)/Math.ceil(e.detail.duration)*100)/100;a>.8&&0==this.receive_status&&(this.receive_int(),this.receive_status=!0)}this.currentTime=t,this.duration=i}},sliderChange:function(e){v.seek(e.detail.value)},sliderChanging:function(e){this.currentTime=e.detail.value},loadedmetadata:function(e){this.duration=e.detail.duration},pause:function(e){},tips:function(){this.$refs.share.share()},timeupdate:function(e){if(this.duration_time=e.detail.duration,(this.indexs||0===this.indexs)&&Math.ceil(e.detail.currentTime)%10==0&&Math.ceil(e.detail.currentTime)!=this.record_time){this.record_time=Math.ceil(e.detail.currentTime),this.record_play(e.detail.currentTime,e.detail.duration);var t=Math.round(Math.ceil(e.detail.currentTime)/Math.ceil(e.detail.duration)*100)/100;t>.8&&0==this.receive_status&&(this.receive_int(),this.receive_status=!0)}},record_play:function(e,t){var i=this;if(!isNaN(t))return new Promise((function(a,n){i.service.entire(i,"post",i.APIconfig.api_root.com_page.v_playProcess,{video_id:i.id,user_id:i.$store.state.user.id,section_id:i.catalog_data[i.indexs].id,play_time:e,s_process:t},(function(e,t){e.duration_time=0,e.catalog_data[e.indexs].section_plan=t.section_plan,a("suc")}))}))},receive_int:function(){this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_integral,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,section_id:this.catalog_data[this.indexs].id},(function(e,t){}))},play_start:function(e){0==this.play_store&&(this.play_store=!0,this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_playCount,{video_id:this.id,userid:this.$store.state.user.id},(function(e,t){})))},chiose_video:function(t,i,a){var n=this;0==i?e.showModal({title:"提示",content:"是否购买该视频？",success:function(e){e.confirm&&n.order_sn()}}):(this.indexs=t,this.play_url=this.service.analysis_url(this.catalog_data[t].video_url),this.initial_time=this.catalog_data[t].play_time)},play_end:function(t){var i=this;return l(a.default.mark((function t(){var n;return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=function(t){var i=this;0==this.catalog_data[t].cou_is_free?e.showModal({title:"提示",content:"该视频需要购买才能继续观看，是否购买？",success:function(e){e.confirm?i.order_sn():e.cancel&&i.indexs--}}):(this.play_url=this.service.analysis_url(this.catalog_data[t].video_url),this.initial_time=this.catalog_data[t].play_time)},!i.indexs&&0!==i.indexs){t.next=13;break}return i,i.record_time=0,t.next=6,i.record_play(i.duration_time,i.duration_time);case 6:if(0==i.receive_status?i.receive_int():i.receive_status=!1,i.indexs!==i.catalog_data.length-1){t.next=9;break}return t.abrupt("return");case 9:i.indexs++,n.call(i,i.indexs),t.next=15;break;case 13:i.indexs=0,n.call(i,i.indexs);case 15:case"end":return t.stop()}}),t)})))()},collect:function(){var t=this.service.loading();this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_collect,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,c_type:1==this.collects?0:1},(function(i,a){e.hideLoading(),clearTimeout(t),i.tips_test=a.msg,i.tips_img=n.default,i.show=!0,setTimeout((function(){i.show=!1}),1500),0==a.code&&(1==i.collects?i.collects=0:i.collects=1)}))},play_integral:function(){var t=this.service.loading();this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_integral,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,section_id:1},(function(i,a){e.hideLoading(),clearTimeout(t),i.tips_test=a.msg,i.tips_img=r.default,i.show=!0,setTimeout((function(){i.show=!1}),1500)}))},getCoupon:function(t,i,a){i||this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_getCoupon,{userid:this.$store.state.user.id,coupon_id:t},(function(i,n){e.showToast({icon:"none",title:n.msg}),0==n.code&&(i.coupon_data[a].c_id=t)}))},order_sn:function(t){var i=t||0;this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_addOrder,{userid:this.$store.state.user.id,video_id:this.id,section_id:i},(function(t,a){0==a.code?t.$jump("./v_order?id="+t.id+"&s_id="+i+"&order_sn="+a.data.order_sn+"&type="+t.type):e.showToast({icon:"none",title:a.msg})}))},initAudio:function(){var e=this,t=v;t.startTime=this.initial_time,t.paused&&t.play(),t.onPlay((function(){e.play_start.call(this)})),t.onTimeUpdate((function(){var i=t.duration,a=t.currentTime,n={detail:{duration:i,currentTime:a}};e.Au_timeupdate.apply(this,[n])})),t.onEnded((function(){e.status=1,e.play_end.call(this)}))},async_n:function(){var e=this;return l(a.default.mark((function t(){return a.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.service.asy_entire(e,"post",e.APIconfig.api_root.com_page.VideoDetail,{video_id:e.id,userid:e.$store.state.user.id,mobile:e.$store.state.user.mobile},(function(e,t){e.data=t.data,t.data.video.v_url?e.play_url=e.service.analysis_url(t.data.video.v_url):e.indexs=0,e.video_data=t.data.video,0!=e.video_data.is_online&&(e.test_show=0),e.share_arr.Title=t.data.video.long_title,e.share_arr.Summary=t.data.video.short_content,e.share_arr.ImageUrl=e.$api_img()+t.data.video.v_pic;var i=t.data.video.video_content,a=new RegExp("<img","gi");e.video_content=i.replace(a,'<img style="max-width: 100%;"'),e.collects=t.data.video.collect,e.poster=t.data.video.screensaver,e.video_data.evaluate&&(e.video_data.stars_num=new Array(Number(e.video_data.evaluate)))}));case 2:return t.next=4,e.service.asy_entire(e,"post",e.APIconfig.api_root.com_page.catalogue,{video_id:e.id,user_id:e.$store.state.user.id},(function(e,t){var i=t.data.video_list;if(0==e.is_free){var a,n=s(i);try{for(n.s();!(a=n.n()).done;){var r=a.value;r.cou_is_free=!0}}catch(g){n.e(g)}finally{n.f()}}else{var o,c=s(i);try{for(c.s();!(o=c.n()).done;){var d=o.value;d.cou_is_free=!1}}catch(g){c.e(g)}finally{c.f()}if(1==e.data.vorder.is_bay_all){var u,l=s(i);try{for(l.s();!(u=l.n()).done;){var _=u.value;_.cou_is_free=!0}}catch(g){l.e(g)}finally{l.f()}}else if(0==e.data.vorder.is_bay_all){var f,h=s(i);try{for(h.s();!(f=h.n()).done;){var p=f.value;p.cou_is_free=!1}}catch(g){h.e(g)}finally{h.f()}}}if(t.data.video.new_play){e.indexs=t.play_index,e.play_url=e.service.analysis_url(i[t.play_index].video_url);var m=t.data.video.new_play.play_time;e.initial_time=m>10?m-5:m}e.catalog_data=i,e.load_show=!1,2==e.type&&(v.title=e.video_data.long_title,v.singer=e.video_data.name,v.coverImgUrl=e.poster,v.src=e.play_url,e.initAudio())}));case 4:case"end":return t.stop()}}),t)})))()}},created:function(){},onShow:function(){this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_evaluate,{userid:this.$store.state.user.id,video_id:this.id,page:1,limit:2},(function(e,t){e.comments=t.data.data;var i,a=s(e.comments);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.rating_num=new Array(Number(n.grade))}}catch(r){a.e(r)}finally{a.f()}}))},onLoad:function(e){this.share_arr.Url="https://www.wufu-app.com/h5/#/pages/com_page/share_video?id="+e.id+"&type="+e.type,this.id=e.id,this.type=e.type,this.async_n(),this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_coupon,{userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile},(function(e,t){e.coupon_data=t.data.coupon})),this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_recommend,{userid:this.$store.state.user.id,video_id:e.id,page:1,limit:2,type:1},(function(e,t){e.recommend_video=t.data.video_list}))},onHide:function(){},onUnload:function(){v.pause(),this.status=1}};function m(e){if(0===e||"number"!==typeof e||isNaN(e)||e<0)return"00:00";var t=Math.floor(e/60),i=Math.floor(e%60);return t<10&&(t="0"+t),i<10&&(i="0"+i),t+":"+i}t.default=p}).call(this,i("6e42")["default"])},"61ba":function(e,t,i){"use strict";(function(e){i("7932"),i("921b");a(i("66fd"));var t=a(i("e08f"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])},6700:function(e,t,i){"use strict";var a,n=function(){var e=this,t=e.$createElement,i=(e._self._c,e.service.NumEllipsis(e.video_data.view)),a=e.$api_img(),n=e.$api_img(),r=e.__map(e.comments,(function(t,i){var a=e.service.Test(t.created_at);return{$orig:e.__get_orig(t),g1:a}})),o=e.$api_img(),s=e.__map(e.recommend_video,(function(t,i){var a=Number(t.v_price),n=Number(t.v_price),r=e.service.NumEllipsis(t.view);return{$orig:e.__get_orig(t),m3:a,m4:n,g2:r}})),c=e.service.Test(Date.parse(new Date)/1e3),d=e.__map(e.coupon_data,(function(t,i){var a=Number(t.where_order_price),n=Number(t.discount_value),r=e.service.Test(Date.parse(new Date)/1e3+3600*t.expire_hour),o=e.service.Test(t.fixed_time_start),s=e.service.Test(t.fixed_time_end);return{$orig:e.__get_orig(t),m5:a,m6:n,g4:r,g5:o,g6:s}})),u=Number(e.video_data.v_price);e._isMounted||(e.e0=function(t){return e.service.returns()},e.e1=function(t){e.lock=!0},e.e2=function(t){e.lock=!1},e.e3=function(t){e.test_show=1},e.e4=function(t){e.test_show=0},e.e5=function(t){e.test_show=2},e.e6=function(t){e.test_show=3},e.e7=function(t){e.coupon_show=!e.coupon_show},e.e8=function(t){e.coupon_show=!1},e.e9=function(t){e.coupon_show=!1}),e.$mp.data=Object.assign({},{$root:{g0:i,m0:a,m1:n,l0:r,m2:o,l1:s,g3:c,l2:d,m7:u}})},r=[];i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return r})),i.d(t,"a",(function(){return a}))},"7e87":function(e,t,i){"use strict";var a=i("9dcc"),n=i.n(a);n.a},"9dcc":function(e,t,i){},e08f:function(e,t,i){"use strict";i.r(t);var a=i("6700"),n=i("3ae8");for(var r in n)"default"!==r&&function(e){i.d(t,e,(function(){return n[e]}))}(r);i("7e87");var o,s=i("f0c5"),c=Object(s["a"])(n["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);t["default"]=c.exports}},[["61ba","common/runtime","common/vendor"]]]);