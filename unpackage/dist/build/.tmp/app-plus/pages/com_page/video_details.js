(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/com_page/video_details"],{"0bb7":function(t,e,i){"use strict";(function(t){i("aa56"),i("921b");o(i("66fd"));var e=o(i("504d"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},4138:function(t,e,i){"use strict";i.r(e);var o=i("46b8"),s=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);e["default"]=s.a},"46b8":function(t,e,i){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("a34a")),a=n(i("a8e2")),r=n(i("5a57"));function n(t){return t&&t.__esModule?t:{default:t}}function c(t,e,i,o,s,a,r){try{var n=t[a](r),c=n.value}catch(d){return void i(d)}n.done?e(c):Promise.resolve(c).then(o,s)}function d(t){return function(){var e=this,i=arguments;return new Promise(function(o,s){var a=t.apply(e,i);function r(t){c(a,o,s,r,n,"next",t)}function n(t){c(a,o,s,r,n,"throw",t)}r(void 0)})}}var u=function(){return i.e("pages/common/load").then(i.bind(null,"3980"))},l={components:{load:u},data:function(){return{id:"",type:"",data:"",video_data:"",test_show:0,catalog_data:"",play_url:"",indexs:"",show:!1,collects:"",tips_test:"",tips_img:"",coupon_data:"",coupon_show:!1,comments:"",recommend_video:"",play_store:!1,poster:"",record_time:0,load_show:!0,duration_time:"",receive_status:!1,initial_time:0,give_show:!1}},computed:{is_free:function(){return 1!=this.video_data.is_free&&(0==this.video_data.is_free?-1==this.video_data.is_free_vip.indexOf(this.$store.state.user.level_id)&&1!=this.data.vorder.is_bay_all:void 0)}},methods:{pause:function(t){},timeupdate:function(t){if(this.duration_time=t.detail.duration,(this.indexs||0===this.indexs)&&Math.ceil(t.detail.currentTime)%10==0&&Math.ceil(t.detail.currentTime)!=this.record_time){this.record_time=Math.ceil(t.detail.currentTime),this.record_play(t.detail.currentTime,t.detail.duration);var e=Math.round(Math.ceil(t.detail.currentTime)/Math.ceil(t.detail.duration)*100)/100;e>.8&&0==this.receive_status&&(this.receive_int(),this.receive_status=!0)}},record_play:function(t,e){isNaN(e)||this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_playProcess,{video_id:this.id,user_id:this.$store.state.user.id,section_id:this.catalog_data[this.indexs].id,play_time:t,s_process:e},function(t,e){t.duration_time=0,t.catalog_data[t.indexs].section_plan=e.section_plan})},receive_int:function(){this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_integral,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,section_id:this.catalog_data[this.indexs].id},function(t,e){})},play_start:function(t){0==this.play_store&&(this.play_store=!0,this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_playCount,{video_id:this.id,userid:this.$store.state.user.id},function(t,e){}))},chiose_video:function(e,i,o){var s=this;0==i?t.showModal({title:"提示",content:"是否购买该章节？",success:function(t){t.confirm&&s.$jump("./v_order?id="+s.id+"&s_id="+o)}}):(this.indexs=e,this.initial_time=0,this.play_url=this.service.analysis_url(this.catalog_data[e].video_url))},play_end:function(e){var i=function(e){var i=this;0==this.catalog_data[e].cou_is_free?t.showModal({title:"提示",content:"该章节为付费章节，是否购买该章节？",success:function(t){t.confirm&&i.$jump("./v_order?id="+i.id+"&s_id="+i.catalog_data[e].id)}}):this.play_url=this.service.analysis_url(this.catalog_data[e].video_url)};if(this.indexs||0===this.indexs){if(this.record_time=0,this.record_play(this.duration_time,this.duration_time),0==this.receive_status?this.receive_int():this.receive_status=!1,this.indexs===this.catalog_data.length-1)return;this.indexs++,i.call(this,this.indexs)}else this.indexs=0,i.call(this,this.indexs)},collect:function(){var e=this.service.loading();this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_collect,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,c_type:1==this.collects?0:1},function(i,o){t.hideLoading(),clearTimeout(e),i.tips_test=o.msg,i.tips_img=a.default,i.show=!0,setTimeout(function(){i.show=!1},1500),0==o.code&&(1==i.collects?i.collects=0:i.collects=1)})},play_integral:function(){var e=this.service.loading();this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_integral,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile,section_id:1},function(i,o){t.hideLoading(),clearTimeout(e),i.tips_test=o.msg,i.tips_img=r.default,i.show=!0,setTimeout(function(){i.show=!1},1500)})},getCoupon:function(e,i,s){console.log(o(e,i," at pages\\com_page\\video_details.vue:500")),i||this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_getCoupon,{userid:this.$store.state.user.id,coupon_id:e},function(i,o){t.showToast({icon:"none",title:o.msg}),0==o.code&&(i.coupon_data[s].c_id=e)})},async_n:function(){var t=d(s.default.mark(function t(){return s.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.service.asy_entire(this,"post",this.APIconfig.api_root.com_page.VideoDetail,{video_id:this.id,userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile},function(t,e){t.data=e.data,e.data.video.v_url?t.play_url=t.service.analysis_url(e.data.video.v_url):t.indexs=0,t.video_data=e.data.video,t.collects=e.data.video.collect,t.poster=e.data.video.v_pic,t.video_data.evaluate&&(t.video_data.stars_num=new Array(Number(t.video_data.evaluate)))});case 2:return t.next=4,this.service.asy_entire(this,"post",this.APIconfig.api_root.com_page.catalogue,{video_id:this.id,user_id:this.$store.state.user.id},function(t,e){var i=e.data.video_list;if(0==t.is_free){var s=!0,a=!1,r=void 0;try{for(var n,c=i[Symbol.iterator]();!(s=(n=c.next()).done);s=!0){var d=n.value;d.cou_is_free=!0}}catch(N){a=!0,r=N}finally{try{s||null==c.return||c.return()}finally{if(a)throw r}}}else{var u=!0,l=!1,_=void 0;try{for(var h,v=i[Symbol.iterator]();!(u=(h=v.next()).done);u=!0){var f=h.value;f.cou_is_free=!1}}catch(N){l=!0,_=N}finally{try{u||null==v.return||v.return()}finally{if(l)throw _}}if(1==t.data.vorder.is_bay_all){var p=!0,m=!1,g=void 0;try{for(var y,w=i[Symbol.iterator]();!(p=(y=w.next()).done);p=!0){var b=y.value;b.cou_is_free=!0}}catch(N){m=!0,g=N}finally{try{p||null==w.return||w.return()}finally{if(m)throw g}}}else if(0==t.data.vorder.is_bay_all){var x=!0,$=!1,P=void 0;try{for(var T,A=i[Symbol.iterator]();!(x=(T=A.next()).done);x=!0){var M=T.value;-1==t.data.vorder.section_all.indexOf(M.id)&&0!=M.v_price||(M.cou_is_free=!0)}}catch(N){$=!0,P=N}finally{try{x||null==A.return||A.return()}finally{if($)throw P}}}}if(e.data.video.new_play){console.log(o(i[e.play_index]," at pages\\com_page\\video_details.vue:557")),t.indexs=e.play_index,t.play_url=t.service.analysis_url(i[e.play_index].video_url);var I=e.data.video.new_play.play_time;t.initial_time=I>10?I-10:I}t.catalog_data=i,t.load_show=!1});case 4:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}()},onShow:function(){this.async_n(),this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_evaluate,{userid:this.$store.state.user.id,video_id:this.id,page:1,limit:2},function(t,e){t.comments=e.data.data;var i=!0,o=!1,s=void 0;try{for(var a,r=t.comments[Symbol.iterator]();!(i=(a=r.next()).done);i=!0){var n=a.value;n.rating_num=new Array(Number(n.grade))}}catch(c){o=!0,s=c}finally{try{i||null==r.return||r.return()}finally{if(o)throw s}}})},onLoad:function(t){this.id=t.id,this.type=t.type,this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_coupon,{userid:this.$store.state.user.id,mobile:this.$store.state.user.mobile},function(t,e){t.coupon_data=e.data.coupon}),this.service.entire(this,"post",this.APIconfig.api_root.com_page.v_recommend,{userid:this.$store.state.user.id,video_id:t.id,page:1,limit:2,type:1},function(t,e){t.recommend_video=e.data.video_list})}};e.default=l}).call(this,i("6e42")["default"],i("0de9")["default"])},"504d":function(t,e,i){"use strict";i.r(e);var o=i("efea"),s=i("4138");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("c6ae");var r,n=i("f0c5"),c=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],r);e["default"]=c.exports},5680:function(t,e,i){},c6ae:function(t,e,i){"use strict";var o=i("5680"),s=i.n(o);s.a},efea:function(t,e,i){"use strict";var o,s=function(){var t=this,e=t.$createElement,i=(t._self._c,t.__map(t.comments,function(e,i){var o=t.service.Test(e.created_at);return{$orig:t.__get_orig(e),g0:o}})),o=t.service.Test(Date.parse(new Date)/1e3),s=t.__map(t.coupon_data,function(e,i){var o=Number(e.where_order_price),s=Number(e.discount_value),a=t.service.Test(Date.parse(new Date)/1e3+3600*e.expire_hour),r=t.service.Test(e.fixed_time_start),n=t.service.Test(e.fixed_time_end);return{$orig:t.__get_orig(e),m0:o,m1:s,g2:a,g3:r,g4:n}});t._isMounted||(t.e0=function(e){return t.service.returns()},t.e1=function(e){t.test_show=0},t.e2=function(e){t.test_show=1},t.e3=function(e){t.test_show=2},t.e4=function(e){t.test_show=3},t.e5=function(e){t.coupon_show=!t.coupon_show},t.e6=function(e){t.coupon_show=!1,t.give_show=!1},t.e7=function(e){t.coupon_show=!1},t.e8=function(e){t.give_show=!1},t.e9=function(e){t.give_show=!0}),t.$mp.data=Object.assign({},{$root:{l0:i,g1:o,l1:s}})},a=[];i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"a",function(){return o})}},[["0bb7","common/runtime","common/vendor"]]]);